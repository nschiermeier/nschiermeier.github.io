<!DOCTYPE html>
<html>
  <head>
    <title>World of Nicholas | Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" type="image/x-icon" href="../Images/icon.png">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script> <!-- Script to add markdown to html -->
	<script>
	  window.MathJax = {
	    tex: {
		  inlineMath: [['$', '$'], ['\\(', '\\)']],
		  displayMath: [['$$', '$$'], ['\\[', '\\]']]
		},
		options: {
		  skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		}
	  };
	</script> <!-- Script to add LaTeX (MathJax) to html -->
	
	<script
	  id="MathJax-script"
	  async
	  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
	</script> <!-- Second part of LaTeX script -->
	
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <li><a href="../">Home</a></li>
          <li><a href="../">About</a></li>
          <li><a href="../contact">Contact</a></li>
          <li><a href="../projects">Projects</a></li>
          <li><a href=".">My Blog</a></li>
        </ul>
      </nav>
      <hr>
    </header>

    <div class="blog-container">
      <h1> The log(N) </h1>

      <p>Updates on my life! Mostly class re-caps as a way to help me study, but could include other stories as well. This is the log of N -- think like a Blog, but more Nick! <a href="archive">Archive</a></p>
      <p style="color:#ffffcd; font-size:0.5em">Courtesy to Daniel for coming up with the title of the blog!</p>

      <div id="posts"></div>

    </div>

  <script>
    async function loadPosts() {
      try {
		
        const response = await fetch('posts.json');
        const posts = await response.json()
        const container = document.getElementById('posts');
		const visiblePosts = posts.filter(p => p.status === "active");

        for (const post of visiblePosts) {
          // fetch markdown file for post
          const mdResponse = await fetch(post.file);
          const mdText = await mdResponse.text();
          const html = marked.parse(mdText);

          // create rest of blog post block
          const postDiv = document.createElement('div');
          postDiv.classList.add('post');
          postDiv.innerHTML = `
            <div class="date">${post.date}</div>
            <h2>${post.title}</h2>
            <p class="snippet">${post.snippet}</p>
            <div class="full-post">
              ${html}
            </div>
            <span class="read-more">Read more ↓</span>
          `;
          container.appendChild(postDiv);
		  
		  // Render LaTeX with MathJax
		  if (window.MathJax) {
		    MathJax.typesetPromise();
		  }
        };

        document.querySelectorAll(".read-more").forEach(button => {
          button.addEventListener("click", () => {
            const post = button.previousElementSibling;
            const isOpen = post.classList.contains("open");

            if (isOpen) {
              // Collapse
              post.style.maxHeight = post.scrollHeight + "px"; // set current height first
              // Force reflow so the browser catches the change
              void post.offsetHeight;
              post.style.maxHeight = "0";
              post.classList.remove("open");
              button.textContent = "Read more ↓";
          } else {
            // Expand (with slight delay for smoothness)
            post.classList.add("open");
            post.style.maxHeight = "0";
            // Force reflow and then set height
            void post.offsetHeight;
            post.style.maxHeight = post.scrollHeight + "px";
            button.textContent = "Read less ↑";
          }
        });
      });
    } catch (error) {
      console.error('Error loading Posts:', error);
      document.getElementById('posts').innerHTML = "<p>Failed to load blog posts.</p>";
    }
  }

  loadPosts();
 </script>

  </body>

</html>
